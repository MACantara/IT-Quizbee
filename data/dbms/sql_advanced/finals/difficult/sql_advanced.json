{
  "subtopic_id": "sql_advanced",
  "subtopic_name": "Advanced SQL",
  "mode": "finals",
  "difficulty": "difficult",
  "questions": [
    {
      "question": "What window function assigns ranks with gaps for ties?",
      "answer": "RANK",
      "alternatives": [],
      "explanation": "RANK() assigns the same rank to ties but skips subsequent ranks, creating gaps."
    },
    {
      "question": "What window function assigns consecutive ranks for ties?",
      "answer": "DENSE_RANK",
      "alternatives": [],
      "explanation": "DENSE_RANK() assigns the same rank to ties without skipping any rank numbers."
    },
    {
      "question": "What clause divides result sets into groups for window functions?",
      "answer": "PARTITION BY",
      "alternatives": [],
      "explanation": "PARTITION BY divides rows into groups, applying window functions separately to each partition."
    },
    {
      "question": "What function accesses data from a previous row in the result set?",
      "answer": "LAG",
      "alternatives": [],
      "explanation": "LAG() retrieves values from preceding rows without using self-joins."
    },
    {
      "question": "What function accesses data from a following row in the result set?",
      "answer": "LEAD",
      "alternatives": [],
      "explanation": "LEAD() retrieves values from subsequent rows in the ordered result set."
    },
    {
      "question": "What function returns the first value in an ordered partition?",
      "answer": "FIRST_VALUE",
      "alternatives": [],
      "explanation": "FIRST_VALUE() gets the first value in the current window frame or partition."
    },
    {
      "question": "What function returns the last value in an ordered partition?",
      "answer": "LAST_VALUE",
      "alternatives": [],
      "explanation": "LAST_VALUE() gets the last value in the current window frame or partition."
    },
    {
      "question": "What technique optimizes subqueries by caching results?",
      "answer": "Materialization",
      "alternatives": ["Subquery Materialization"],
      "explanation": "Materialization stores subquery results in a temporary table to avoid repeated execution."
    },
    {
      "question": "What operator compares a value to any value in a subquery?",
      "answer": "ANY",
      "alternatives": ["SOME"],
      "explanation": "ANY compares against at least one value in the subquery result; SOME is equivalent."
    },
    {
      "question": "What function divides rows into specified number of groups?",
      "answer": "NTILE",
      "alternatives": [],
      "explanation": "NTILE() distributes rows into a specified number of approximately equal groups."
    }
  ]
}