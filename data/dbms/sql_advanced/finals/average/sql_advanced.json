{
  "subtopic_id": "sql_advanced",
  "subtopic_name": "Advanced SQL",
  "mode": "finals",
  "difficulty": "average",
  "questions": [
    {
      "question": "What type of subquery references columns from the outer query?",
      "answer": "Correlated Subquery",
      "alternatives": [],
      "explanation": "A correlated subquery depends on the outer query, executing once per outer row."
    },
    {
      "question": "What type of subquery returns exactly one value?",
      "answer": "Single-row Subquery",
      "alternatives": ["Scalar Subquery"],
      "explanation": "A single-row subquery returns one row with one column, used with comparison operators."
    },
    {
      "question": "What type of join combines all possible pairs of rows?",
      "answer": "Cross Join",
      "alternatives": ["Cartesian Join"],
      "explanation": "Cross join produces the Cartesian product, pairing every row from one table with every row from another."
    },
    {
      "question": "What join uses equality conditions on same-named columns?",
      "answer": "Natural Join",
      "alternatives": [],
      "explanation": "Natural join automatically joins tables based on all columns with identical names."
    },
    {
      "question": "What statement combines INSERT and UPDATE operations?",
      "answer": "MERGE",
      "alternatives": ["UPSERT"],
      "explanation": "MERGE performs INSERT if no match exists, UPDATE if a match is found, in one statement."
    },
    {
      "question": "What function assigns sequential numbers to rows?",
      "answer": "ROW_NUMBER",
      "alternatives": [],
      "explanation": "ROW_NUMBER() assigns a unique sequential integer to each row in the result set."
    },
    {
      "question": "What clause defines the window for window functions?",
      "answer": "OVER",
      "alternatives": [],
      "explanation": "OVER defines the partitioning and ordering for window function calculations."
    },
    {
      "question": "What expression provides conditional logic in SQL?",
      "answer": "CASE",
      "alternatives": ["CASE expression", "CASE WHEN"],
      "explanation": "CASE evaluates conditions and returns different values based on which condition is true."
    },
    {
      "question": "What temporary named result set exists within a query?",
      "answer": "Common Table Expression",
      "alternatives": ["CTE"],
      "explanation": "A CTE is defined using WITH clause and can be referenced within the query scope."
    },
    {
      "question": "What operator compares a value to all values in a subquery?",
      "answer": "ALL",
      "alternatives": [],
      "explanation": "ALL compares a value against every value returned by a subquery."
    }
  ]
}